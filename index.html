<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç–∞</title>
  <style>
    :root{
      --bg:#0b0c10;
      --card:#111318;
      --text:#e9eef5;
      --muted:#9aa7b2;
      --primary:#6aa7ff;
      --accent:#c29bff;
      --success:#28c281;
      --warning:#ffb347;
      --danger:#ff6b6b;
      --border:#23262d;
      --radius:16px;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --grad:linear-gradient(135deg,var(--primary),var(--accent));
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;
      padding:0;
      background:radial-gradient(1200px 600px at 80% -10%,rgba(106,167,255,.15),transparent),
                 radial-gradient(900px 500px at -10% 10%,rgba(194,155,255,.12),transparent),
                 var(--bg);
      color:var(--text);
      font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
      min-height:100vh;
    }
    .container{
      max-width:700px;
      margin:0 auto;
      padding:40px 20px;
    }
    .header{
      text-align:center;
      margin-bottom:40px;
    }
    .header h1{
      font-weight:800;
      font-size:clamp(28px,6vw,36px);
      line-height:1.2;
      margin:0 0 8px;
    }
    .header p{
      color:var(--muted);
      margin:0;
    }
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.00));
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:32px;
    }
    .form-group{
      margin-bottom:28px;
    }
    .form-label{
      display:block;
      font-weight:700;
      margin-bottom:10px;
      font-size:15px;
    }
    .form-input{
      width:100%;
      padding:14px 16px;
      background:rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius:12px;
      color:var(--text);
      font-size:15px;
      font-family:inherit;
      transition:all .2s;
    }
    .form-input:focus{
      outline:none;
      border-color:var(--primary);
      background:rgba(106,167,255,.05);
    }
    .form-input::placeholder{
      color:var(--muted);
    }
    .content-type-buttons{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:12px;
    }
    .type-btn{
      padding:16px 12px;
      background:rgba(255,255,255,.03);
      border:2px solid var(--border);
      border-radius:12px;
      color:var(--text);
      font-weight:600;
      font-size:15px;
      cursor:pointer;
      transition:all .2s;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:8px;
      min-height:90px;
    }
    .type-btn:hover{
      background:rgba(255,255,255,.06);
      transform:translateY(-2px);
    }
    .type-btn.active{
      background:var(--grad);
      border-color:transparent;
      color:#0b1020;
    }
    .type-btn .icon{
      font-size:24px;
    }
    .type-btn .label{
      font-size:14px;
    }
    .platform-buttons{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:12px;
    }
    .platform-btn{
      padding:14px 16px;
      background:rgba(255,255,255,.03);
      border:2px solid var(--border);
      border-radius:12px;
      color:var(--text);
      font-weight:600;
      font-size:14px;
      cursor:pointer;
      transition:all .2s;
      display:flex;
      align-items:center;
      justify-content:flex-start;
      gap:10px;
      min-height:50px;
    }
    .platform-btn:hover{
      background:rgba(255,255,255,.06);
      transform:translateY(-2px);
    }
    .platform-btn.active{
      background:var(--grad);
      border-color:transparent;
      color:#0b1020;
    }
    .platform-btn .icon{
      font-size:18px;
      min-width:20px;
    }
    .submit-btn{
      width:100%;
      padding:16px;
      background:var(--grad);
      border:none;
      border-radius:12px;
      color:#0b1020;
      font-weight:800;
      font-size:16px;
      cursor:pointer;
      transition:all .2s;
      margin-top:12px;
    }
    .submit-btn:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(106,167,255,.4);
    }
    .submit-btn:disabled{
      opacity:.5;
      cursor:not-allowed;
      transform:none;
    }
    .modal{
      display:none;
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,.7);
      backdrop-filter:blur(8px);
      z-index:1000;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .modal.show{
      display:flex;
    }
    .modal-content{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:32px;
      max-width:500px;
      width:100%;
      box-shadow:0 20px 60px rgba(0,0,0,.5);
    }
    .modal-header{
      font-size:22px;
      font-weight:800;
      margin:0 0 20px;
    }
    .modal-body{
      margin-bottom:24px;
    }
    .confirmation-item{
      padding:12px;
      background:rgba(255,255,255,.03);
      border-radius:8px;
      margin-bottom:8px;
    }
    .confirmation-label{
      color:var(--muted);
      font-size:13px;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.5px;
      margin-bottom:4px;
    }
    .confirmation-value{
      color:var(--text);
      font-weight:500;
    }
    .modal-actions{
      display:flex;
      gap:12px;
    }
    .modal-btn{
      flex:1;
      padding:14px;
      border:none;
      border-radius:10px;
      font-weight:700;
      font-size:15px;
      cursor:pointer;
      transition:all .2s;
    }
    .modal-btn.confirm{
      background:var(--grad);
      color:#0b1020;
    }
    .modal-btn.cancel{
      background:rgba(255,255,255,.05);
      color:var(--text);
      border:1px solid var(--border);
    }
    .modal-btn:hover{
      transform:translateY(-2px);
    }
    .success-message{
      background:rgba(40,194,129,.1);
      border:1px solid rgba(40,194,129,.3);
      color:var(--success);
      padding:16px;
      border-radius:12px;
      margin-top:20px;
      text-align:center;
      font-weight:600;
      display:none;
    }
    .success-message.show{
      display:block;
      animation:slideIn .3s ease;
    }
    @keyframes slideIn{
      from{
        opacity:0;
        transform:translateY(-10px);
      }
      to{
        opacity:1;
        transform:translateY(0);
      }
    }
    .error-message{
      background:rgba(255,107,107,.1);
      border:1px solid rgba(255,107,107,.3);
      color:var(--danger);
      padding:16px;
      border-radius:12px;
      margin-top:20px;
      text-align:center;
      font-weight:600;
      display:none;
    }
    .error-message.show{
      display:block;
      animation:slideIn .3s ease;
    }
    .helper-text{
      font-size:13px;
      color:var(--muted);
      margin-top:8px;
    }
    .checkbox-wrapper{
      display:flex;
      align-items:center;
      gap:8px;
      margin-top:12px;
    }
    .checkbox{
      width:18px;
      height:18px;
      cursor:pointer;
    }
    .checkbox-label{
      font-size:14px;
      color:var(--muted);
      cursor:pointer;
    }
    #deadlineGroup{
      display:none;
    }
    #deadlineGroup.show{
      display:block;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üì± –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h1>
      <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö</p>
    </div>

    <div class="card">
      <form id="taskForm">
        <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª -->
        <div class="form-group">
          <label class="form-label">üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª</label>
          <input 
            type="url" 
            class="form-input" 
            id="materialLink" 
            placeholder="https://example.com/material"
            required
          />
        </div>

        <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
        <div class="form-group">
          <label class="form-label">üìã –¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞</label>
          <div class="content-type-buttons">
            <button type="button" class="type-btn" data-type="post">
              <span class="icon">üìù</span>
              <span class="label">–ü–æ—Å—Ç</span>
            </button>
            <button type="button" class="type-btn" data-type="video">
              <span class="icon">üé¨</span>
              <span class="label">–†–æ–ª–∏–∫</span>
            </button>
            <button type="button" class="type-btn" data-type="carousel">
              <span class="icon">üé†</span>
              <span class="label">–ö–∞—Ä—É—Å–µ–ª—å</span>
            </button>
          </div>
        </div>

        <!-- –í—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è) -->
        <div class="form-group" id="platformsGroup" style="display:none;">
          <label class="form-label">üåê –ì–¥–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</label>
          <div class="platform-buttons" id="platformButtons">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JS -->
          </div>
        </div>

        <!-- –ß–µ–∫–±–æ–∫—Å –¥–ª—è –¥–µ–¥–ª–∞–π–Ω–∞ -->
        <div class="form-group">
          <div class="checkbox-wrapper">
            <input type="checkbox" id="hasDeadline" class="checkbox" />
            <label for="hasDeadline" class="checkbox-label">–£–∫–∞–∑–∞—Ç—å –¥–µ–¥–ª–∞–π–Ω</label>
          </div>
        </div>

        <!-- –î–µ–¥–ª–∞–π–Ω (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —á–µ–∫–±–æ–∫—Å–∞) -->
        <div class="form-group" id="deadlineGroup">
          <label class="form-label">üìÖ –î–µ–¥–ª–∞–π–Ω</label>
          <input 
            type="datetime-local" 
            class="form-input" 
            id="deadline"
          />
        </div>

        <button type="submit" class="submit-btn">
          ‚ú® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–∞—á–∏
        </button>
      </form>

      <div class="success-message" id="successMessage">
        ‚úÖ –ó–∞–¥–∞—á–∏ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Google –¢–∞–±–ª–∏—Ü—É!
      </div>

      <div class="error-message" id="errorMessage">
        ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
  <div class="modal" id="confirmModal">
    <div class="modal-content">
      <h2 class="modal-header">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á</h2>
      <div class="modal-body" id="confirmationBody">
        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
      </div>
      <div class="modal-actions">
        <button class="modal-btn cancel" id="cancelBtn">–û—Ç–º–µ–Ω–∞</button>
        <button class="modal-btn confirm" id="confirmBtn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // URL Google Apps Script
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxka-rn9iqflw2p0I5yvwlYxieKj5CXas_ZQ1ZpOe1dpIE0Fm0epOu_YkVdG2hD32fhog/exec';
    
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    const PLATFORMS = {
      post: [
        { id: 'vk-personal', name: '–í–ö - –ª–∏—á–Ω—ã–π –∞–∫–∫', icon: 'üë§' },
        { id: 'vk-group', name: '–í–ö - –ø–æ—Å—Ç –≥—Ä—É–ø–ø–∞', icon: 'üë•' },
        { id: 'ok-feed', name: '–û–ö - –ø–æ—Å—Ç –≤ –ª–µ–Ω—Ç—É', icon: 'üü†' },
        { id: 'threads', name: 'Threads', icon: 'üßµ' }
      ],
      video: [
        { id: 'tiktok', name: 'TikTok', icon: 'üéµ' },
        { id: 'youtube-shorts', name: 'YouTube Shorts', icon: 'üì∫' },
        { id: 'vk-clips', name: 'VK –∫–ª–∏–ø—ã', icon: 'üé¨' },
        { id: 'ok-video', name: '–û–ö –≤–∏–¥–µ–æ', icon: 'üé•' },
        { id: 'dzen-video', name: '–î–∑–µ–Ω –≤–∏–¥–µ–æ', icon: 'üìπ' }
      ],
      carousel: [
        { id: 'tiktok', name: 'TikTok', icon: 'üéµ' },
        { id: 'vk-post', name: '–í–ö –ø–æ—Å—Ç', icon: 'üì∏' },
        { id: 'ok-post', name: '–û–ö –ø–æ—Å—Ç', icon: 'üñºÔ∏è' }
      ]
    };

    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    const form = document.getElementById('taskForm');
    const modal = document.getElementById('confirmModal');
    const confirmBtn = document.getElementById('confirmBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const typeButtons = document.querySelectorAll('.type-btn');
    const platformsGroup = document.getElementById('platformsGroup');
    const platformButtons = document.getElementById('platformButtons');
    const hasDeadlineCheckbox = document.getElementById('hasDeadline');
    const deadlineGroup = document.getElementById('deadlineGroup');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    
    let selectedType = null;
    let selectedPlatforms = new Set();
    let formData = {};

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    window.addEventListener('DOMContentLoaded', () => {
      // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã (—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è)
      const now = new Date();
      now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
      document.getElementById('deadline').min = now.toISOString().slice(0, 16);
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ–∫–±–æ–∫—Å–∞ –¥–µ–¥–ª–∞–π–Ω–∞
    hasDeadlineCheckbox.addEventListener('change', (e) => {
      if (e.target.checked) {
        deadlineGroup.classList.add('show');
      } else {
        deadlineGroup.classList.remove('show');
        document.getElementById('deadline').value = '';
      }
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    typeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const type = btn.dataset.type;
        
        // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
        typeButtons.forEach(b => b.classList.remove('active'));
        
        // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é
        btn.classList.add('active');
        selectedType = type;
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        selectedPlatforms.clear();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        renderPlatforms(type);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥—Ä—É–ø–ø—É –ø–ª–∞—Ç—Ñ–æ—Ä–º
        platformsGroup.style.display = 'block';
      });
    });

    // –†–µ–Ω–¥–µ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞
    function renderPlatforms(type) {
      const platforms = PLATFORMS[type];
      platformButtons.innerHTML = '';
      
      platforms.forEach(platform => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'platform-btn';
        btn.dataset.platformId = platform.id;
        btn.innerHTML = `
          <span class="icon">${platform.icon}</span>
          <span>${platform.name}</span>
        `;
        
        btn.addEventListener('click', () => {
          if (selectedPlatforms.has(platform.id)) {
            selectedPlatforms.delete(platform.id);
            btn.classList.remove('active');
          } else {
            selectedPlatforms.add(platform.id);
            btn.classList.add('active');
          }
        });
        
        platformButtons.appendChild(btn);
      });
    }

    // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ ID
    function getPlatformName(platformId) {
      for (const type in PLATFORMS) {
        const platform = PLATFORMS[type].find(p => p.id === platformId);
        if (platform) return platform.name;
      }
      return platformId;
    }

    // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    function getContentTypeName(type) {
      const names = {
        post: '–ü–æ—Å—Ç',
        video: '–†–æ–ª–∏–∫',
        carousel: '–ö–∞—Ä—É—Å–µ–ª—å'
      };
      return names[type] || type;
    }

    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      
      // –°–∫—Ä—ã—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
      successMessage.classList.remove('show');
      errorMessage.classList.remove('show');

      // –í–∞–ª–∏–¥–∞—Ü–∏—è
      if (!selectedType) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞');
        return;
      }

      if (selectedPlatforms.size === 0) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏');
        return;
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥–ª–∞–π–Ω–∞
      const hasDeadline = hasDeadlineCheckbox.checked;
      const deadline = hasDeadline ? document.getElementById('deadline').value : null;
      
      if (hasDeadline && !deadline) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –¥–µ–¥–ª–∞–π–Ω –∏–ª–∏ —Å–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É');
        return;
      }

      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
      formData = {
        materialLink: document.getElementById('materialLink').value,
        contentType: selectedType,
        platforms: Array.from(selectedPlatforms),
        deadline: deadline,
        hasDeadline: hasDeadline
      };

      // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      const contentTypeName = getContentTypeName(formData.contentType);
      const platformNames = formData.platforms.map(id => getPlatformName(id)).join(', ');
      const deadlineFormatted = formData.hasDeadline 
        ? new Date(formData.deadline).toLocaleString('ru-RU')
        : '–ù–µ —É–∫–∞–∑–∞–Ω';
      
      let confirmationHTML = `
        <div class="confirmation-item">
          <div class="confirmation-label">–°—Å—ã–ª–∫–∞ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª</div>
          <div class="confirmation-value">${formData.materialLink}</div>
        </div>
        <div class="confirmation-item">
          <div class="confirmation-label">–¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞</div>
          <div class="confirmation-value">${contentTypeName}</div>
        </div>
        <div class="confirmation-item">
          <div class="confirmation-label">–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã (${formData.platforms.length} –∑–∞–¥–∞—á)</div>
          <div class="confirmation-value">${platformNames}</div>
        </div>
        <div class="confirmation-item">
          <div class="confirmation-label">–î–µ–¥–ª–∞–π–Ω</div>
          <div class="confirmation-value">${deadlineFormatted}</div>
        </div>
      `;

      document.getElementById('confirmationBody').innerHTML = confirmationHTML;
      modal.classList.add('show');
    });

    // –û—Ç–º–µ–Ω–∞
    cancelBtn.addEventListener('click', () => {
      modal.classList.remove('show');
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('show');
      }
    });

    // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Google Sheets
    confirmBtn.addEventListener('click', async () => {
      modal.classList.remove('show');
      
      try {
        // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á
        const tasks = formData.platforms.map(platformId => ({
          materialLink: formData.materialLink,
          contentType: getContentTypeName(formData.contentType),
          platform: getPlatformName(platformId),
          deadline: formData.hasDeadline ? formData.deadline : ''
        }));

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Google Sheets
        const response = await fetch(SCRIPT_URL, {
          method: 'POST',
          mode: 'no-cors',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ tasks: tasks })
        });

        // –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        successMessage.textContent = `‚úÖ ${tasks.length} –∑–∞–¥–∞—á${tasks.length > 1 ? '–∏' : '–∞'} —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω${tasks.length > 1 ? '—ã' : '–∞'} –≤ Google –¢–∞–±–ª–∏—Ü—É!`;
        successMessage.classList.add('show');
        
        // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
        form.reset();
        selectedType = null;
        selectedPlatforms.clear();
        typeButtons.forEach(btn => btn.classList.remove('active'));
        platformsGroup.style.display = 'none';
        deadlineGroup.classList.remove('show');
        hasDeadlineCheckbox.checked = false;

        // –°–∫—Ä—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
        setTimeout(() => {
          successMessage.classList.remove('show');
        }, 5000);

      } catch (error) {
        console.error('–û—à–∏–±–∫–∞:', error);
        errorMessage.classList.add('show');
        
        setTimeout(() => {
          errorMessage.classList.remove('show');
        }, 5000);
      }
    });
  </script>
</body>
</html>
